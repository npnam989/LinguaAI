<Page x:Class="LinguaAI.Desktop.Pages.PronunciationPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Luyá»‡n PhÃ¡t Ã‚m"
      Style="{DynamicResource PageBase}">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="30">
            <!-- Header -->
            <StackPanel HorizontalAlignment="Center" Margin="0,0,0,30">
                <TextBlock Text="ðŸŽ¤ Luyá»‡n PhÃ¡t Ã‚m" Style="{DynamicResource HeaderTitle}" HorizontalAlignment="Center"/>
                <TextBlock Text="NÃ³i theo máº«u vÃ  nháº­n pháº£n há»“i tá»« AI" 
                           Style="{DynamicResource SubtitleText}" HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Settings Panel -->
            <Border Style="{DynamicResource GlassPanel}" HorizontalAlignment="Center" Margin="0,0,0,30">
                <WrapPanel HorizontalAlignment="Center">
                    <StackPanel Margin="10,5">
                        <TextBlock Text="NgÃ´n ngá»¯" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                        <ComboBox x:Name="LanguageComboBox" Width="150" SelectedIndex="0">
                            <ComboBoxItem Content="ðŸ‡°ðŸ‡· Tiáº¿ng HÃ n" Tag="ko"/>
                            <ComboBoxItem Content="ðŸ‡¨ðŸ‡³ Tiáº¿ng Trung" Tag="zh"/>
                            <ComboBoxItem Content="ðŸ‡ºðŸ‡¸ Tiáº¿ng Anh" Tag="en"/>
                        </ComboBox>
                    </StackPanel>
                    <Button x:Name="NewPhraseBtn" Content="ðŸ”„ CÃ¢u má»›i" 
                            Style="{DynamicResource SecondaryButton}" Margin="10,5"
                            VerticalAlignment="Bottom"
                            Click="NewPhrase_Click"/>
                </WrapPanel>
            </Border>

            <!-- Practice Card -->
            <Border Style="{DynamicResource CardStyle}" HorizontalAlignment="Center" MaxWidth="600">
                <StackPanel HorizontalAlignment="Center">
                    <!-- Target Phrase -->
                    <StackPanel Margin="0,0,0,30">
                        <TextBlock x:Name="PhraseText" Text="ì•ˆë…•í•˜ì„¸ìš”" FontSize="36" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}" HorizontalAlignment="Center"/>
                        <TextBlock x:Name="PhraseRomanization" Text="annyeonghaseyo" FontSize="18" 
                                   Foreground="{DynamicResource SecondaryText}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                        <TextBlock x:Name="PhraseMeaning" Text="Xin chÃ o" FontSize="14" 
                                   Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                    </StackPanel>

                    <!-- Audio Visualizer (simple representation) -->
                    <Border Background="{DynamicResource SurfaceBackground}" CornerRadius="8" 
                            Height="60" Width="500" Margin="0,0,0,20">
                        <Canvas x:Name="AudioCanvas"/>
                    </Border>

                    <!-- Record Button -->
                    <Button x:Name="RecordButton" Width="100" Height="100" 
                            Style="{DynamicResource PrimaryButton}"
                            Click="RecordButton_Click">
                        <TextBlock Text="ðŸŽ¤" FontSize="40"/>
                    </Button>
                    <TextBlock x:Name="StatusText" Text="Nháº¥n Ä‘á»ƒ ghi Ã¢m" 
                               Foreground="{DynamicResource MutedText}" 
                               HorizontalAlignment="Center" Margin="0,15,0,0"/>

                    <!-- Spoken Text Result -->
                    <Border x:Name="SpokenArea" Visibility="Collapsed" Margin="0,20,0,0">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="Báº¡n Ä‘Ã£ nÃ³i:" Foreground="{DynamicResource SecondaryText}"/>
                            <TextBlock x:Name="SpokenText" FontSize="18" 
                                       Foreground="{DynamicResource PrimaryLight}" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Score Display -->
                    <Border x:Name="ScoreArea" Visibility="Collapsed" Margin="0,30,0,0">
                        <StackPanel HorizontalAlignment="Center">
                            <!-- Score Circle -->
                            <Border Style="{DynamicResource ScoreCircle}">
                                <TextBlock x:Name="ScoreValue" Text="0" FontSize="36" FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryText}" 
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            
                            <!-- Detailed Result -->
                            <TextBlock x:Name="DetailedResult" FontSize="18" FontWeight="Medium"
                                       Foreground="{DynamicResource PrimaryText}" 
                                       HorizontalAlignment="Center" Margin="0,15,0,0"/>
                            <TextBlock x:Name="FeedbackText" TextWrapping="Wrap" MaxWidth="400"
                                       Foreground="{DynamicResource SecondaryText}" 
                                       TextAlignment="Center" Margin="0,10,0,0"/>

                            <!-- Word-by-word results -->
                            <ItemsControl x:Name="WordResults" Margin="0,20,0,0">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel HorizontalAlignment="Center"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Padding="8,4" Margin="3" CornerRadius="4">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Correct}" Value="True">
                                                            <Setter Property="Background" Value="#22c55e33"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Correct}" Value="False">
                                                            <Setter Property="Background" Value="#ef444433"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <TextBlock Text="{Binding Word}" FontSize="14">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Correct}" Value="True">
                                                                <Setter Property="Foreground" Value="{DynamicResource AccentGreen}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Correct}" Value="False">
                                                                <Setter Property="Foreground" Value="{DynamicResource Error}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>

                    <!-- Loading -->
                    <StackPanel x:Name="LoadingPanel" Visibility="Collapsed" HorizontalAlignment="Center" Margin="0,30">
                        <ProgressBar IsIndeterminate="True" Width="150" Height="4" Foreground="{DynamicResource Primary}"/>
                        <TextBlock Text="Äang phÃ¢n tÃ­ch..." Foreground="{DynamicResource MutedText}" 
                                   HorizontalAlignment="Center" Margin="0,15,0,0"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
