<Page x:Class="LinguaAI.Desktop.Pages.VocabularyPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Há»c Tá»« Vá»±ng"
      Style="{DynamicResource PageBase}">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="30">
            <!-- Header -->
            <StackPanel HorizontalAlignment="Center" Margin="0,0,0,30">
                <TextBlock Text="ðŸ“š Há»c Tá»« Vá»±ng" Style="{DynamicResource HeaderTitle}" HorizontalAlignment="Center"/>
                <TextBlock Text="Há»c tá»« má»›i theo chá»§ Ä‘á» hoáº·c táº£i danh sÃ¡ch tá»« file" 
                           Style="{DynamicResource SubtitleText}" HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Settings Panel -->
            <Border Style="{DynamicResource GlassPanel}" Margin="0,0,0,30">
                <StackPanel>
                    <WrapPanel HorizontalAlignment="Center" Margin="0,0,0,15">
                        <!-- Language Selector -->
                        <StackPanel Margin="10,5">
                            <TextBlock Text="NgÃ´n ngá»¯" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                            <ComboBox x:Name="LanguageComboBox" Width="150" SelectedIndex="0">
                                <ComboBoxItem Content="ðŸ‡°ðŸ‡· Tiáº¿ng HÃ n" Tag="ko"/>
                                <ComboBoxItem Content="ðŸ‡¨ðŸ‡³ Tiáº¿ng Trung" Tag="zh"/>
                                <ComboBoxItem Content="ðŸ‡ºðŸ‡¸ Tiáº¿ng Anh" Tag="en"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- Theme Selector -->
                        <StackPanel Margin="10,5">
                            <TextBlock Text="Chá»§ Ä‘á»" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                            <ComboBox x:Name="ThemeComboBox" Width="180" SelectedIndex="0">
                                <ComboBoxItem Content="ðŸ‘‹ ChÃ o há»i" Tag="greetings"/>
                                <ComboBoxItem Content="ðŸ”¢ Sá»‘ Ä‘áº¿m" Tag="numbers"/>
                                <ComboBoxItem Content="ðŸ• Äá»“ Äƒn" Tag="food"/>
                                <ComboBoxItem Content="ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Gia Ä‘Ã¬nh" Tag="family"/>
                                <ComboBoxItem Content="ðŸŽ¨ MÃ u sáº¯c" Tag="colors"/>
                                <ComboBoxItem Content="ðŸ¾ Äá»™ng váº­t" Tag="animals"/>
                                <ComboBoxItem Content="ðŸŒ¤ï¸ Thá»i tiáº¿t" Tag="weather"/>
                                <ComboBoxItem Content="ðŸ›’ Mua sáº¯m" Tag="shopping"/>
                                <ComboBoxItem Content="ðŸ§³ Du lá»‹ch" Tag="travel"/>
                                <ComboBoxItem Content="ðŸ’¼ CÃ´ng viá»‡c" Tag="work"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <!-- Word Count -->
                        <StackPanel Margin="10,5">
                            <TextBlock Text="Sá»‘ tá»«" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                            <ComboBox x:Name="CountComboBox" Width="80" SelectedIndex="1">
                                <ComboBoxItem Content="5" Tag="5"/>
                                <ComboBoxItem Content="10" Tag="10"/>
                                <ComboBoxItem Content="15" Tag="15"/>
                                <ComboBoxItem Content="20" Tag="20"/>
                            </ComboBox>
                        </StackPanel>
                    </WrapPanel>
                    
                    <!-- Generate Button -->
                    <Button x:Name="GenerateButton" Content="ðŸ“š Táº£i tá»« AI" 
                            Style="{DynamicResource PrimaryButton}"
                            HorizontalAlignment="Center" Margin="0,10,0,0"
                            Click="GenerateButton_Click"/>
                    
                    <!-- File Upload Section -->
                    <Border Margin="0,20,0,0" Padding="15,0,15,15" BorderThickness="0,1,0,0" BorderBrush="{DynamicResource Border}">
                        <StackPanel>
                            <TextBlock Text="ðŸ“¤ Hoáº·c táº£i danh sÃ¡ch tá»« file cá»§a báº¡n" 
                                       Foreground="{DynamicResource SecondaryText}" 
                                       HorizontalAlignment="Center" Margin="0,15,0,10"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button x:Name="UploadButton" Content="ðŸ“ Chá»n file Excel/Word" 
                                        Style="{DynamicResource SecondaryButton}"
                                        Click="UploadButton_Click"/>
                                <TextBlock x:Name="FileNameText" Text="" 
                                           Foreground="{DynamicResource MutedText}" 
                                           VerticalAlignment="Center" Margin="15,0,0,0"/>
                            </StackPanel>
                            <TextBlock Text="Excel: Cá»™t A=Tá»«, B=NghÄ©a, C=PhÃ¡t Ã¢m, D=VÃ­ dá»¥ | Word: Tá»« - NghÄ©a (má»—i dÃ²ng)" 
                                       Foreground="{DynamicResource MutedText}" FontSize="11"
                                       HorizontalAlignment="Center" Margin="0,10,0,0"/>
                            
                            <!-- Download Templates -->
                            <WrapPanel HorizontalAlignment="Center" Margin="0,15,0,0">
                                <Button Content="ðŸ“¥ Táº£i file máº«u Excel" 
                                        Style="{DynamicResource SecondaryButton}"
                                        FontSize="12" Padding="8,4" Margin="5"
                                        Click="DownloadExcelTemplate_Click"/>
                                <Button Content="ðŸ“¥ Táº£i file máº«u Word" 
                                        Style="{DynamicResource SecondaryButton}"
                                        FontSize="12" Padding="8,4" Margin="5"
                                        Click="DownloadWordTemplate_Click"/>
                            </WrapPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Loading -->
            <Border x:Name="LoadingPanel" Visibility="Collapsed" Margin="0,30">
                <StackPanel HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="200" Height="4" Foreground="{DynamicResource Primary}"/>
                    <TextBlock Text="Äang xá»­ lÃ½..." Foreground="{DynamicResource MutedText}" 
                               HorizontalAlignment="Center" Margin="0,15,0,0"/>
                </StackPanel>
            </Border>

            <!-- Mode Selection (visible after loading) -->
            <WrapPanel x:Name="ModePanel" Visibility="Collapsed" HorizontalAlignment="Center" Margin="0,0,0,30">
                <Button x:Name="FlashcardModeBtn" Content="ðŸƒ Flashcard" 
                        Style="{DynamicResource PrimaryButton}" Margin="5"
                        Click="FlashcardMode_Click"/>
                <Button x:Name="QuizModeBtn" Content="ðŸŽ¤ Kiá»ƒm tra nÃ³i" 
                        Style="{DynamicResource SecondaryButton}" Margin="5"
                        Click="QuizMode_Click"/>
                <Button x:Name="ListModeBtn" Content="ðŸ“‹ Danh sÃ¡ch" 
                        Style="{DynamicResource SecondaryButton}" Margin="5"
                        Click="ListMode_Click"/>
            </WrapPanel>

            <!-- Flashcard Area -->
            <Border x:Name="FlashcardArea" Visibility="Collapsed" Margin="0,20">
                <StackPanel HorizontalAlignment="Center">
                    <!-- Progress -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,20">
                        <TextBlock x:Name="CurrentIndexText" Text="1" FontSize="24" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryLight}"/>
                        <TextBlock Text=" / " FontSize="24" Foreground="{DynamicResource MutedText}"/>
                        <TextBlock x:Name="TotalCountText" Text="10" FontSize="24" Foreground="{DynamicResource MutedText}"/>
                    </StackPanel>

                    <!-- Flashcard -->
                    <Border x:Name="Flashcard" Style="{DynamicResource FlashcardFront}" 
                            Width="400" Height="280" Cursor="Hand"
                            MouseLeftButtonDown="Flashcard_Click">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock x:Name="CardWord" Text="" FontSize="32" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" TextWrapping="Wrap"/>
                            <TextBlock x:Name="CardPronunciation" Text="" FontSize="16" 
                                       Foreground="#ffffffcc" HorizontalAlignment="Center" Margin="0,10,0,0"/>
                            <TextBlock x:Name="CardMeaning" Text="" FontSize="18" Visibility="Collapsed"
                                       Foreground="{DynamicResource PrimaryLight}" HorizontalAlignment="Center" 
                                       TextWrapping="Wrap" Margin="0,15,0,0"/>
                            <TextBlock x:Name="CardExample" Text="" FontSize="14" Visibility="Collapsed"
                                       Foreground="{DynamicResource SecondaryText}" HorizontalAlignment="Center" 
                                       TextWrapping="Wrap" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>
                    <TextBlock Text="Nháº¥n vÃ o tháº» Ä‘á»ƒ láº­t" Foreground="{DynamicResource MutedText}" 
                               HorizontalAlignment="Center" Margin="0,15,0,0"/>

                    <!-- Navigation -->
                    <WrapPanel HorizontalAlignment="Center" Margin="0,25,0,0">
                        <Button Content="â¬…ï¸ TrÆ°á»›c" Style="{DynamicResource SecondaryButton}" 
                                Margin="5" Click="PrevCard_Click"/>
                        <Button Content="ðŸ”€ Trá»™n" Style="{DynamicResource SecondaryButton}" 
                                Margin="5" Click="ShuffleCards_Click"/>
                        <Button Content="Tiáº¿p âž¡ï¸" Style="{DynamicResource PrimaryButton}" 
                                Margin="5" Click="NextCard_Click"/>
                    </WrapPanel>
                </StackPanel>
            </Border>

            <!-- Speaking Quiz Area -->
            <Border x:Name="QuizArea" Visibility="Collapsed" Margin="0,20">
                <StackPanel HorizontalAlignment="Center" MaxWidth="500">
                    <!-- Quiz Progress -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,15">
                        <TextBlock Text="CÃ¢u " Foreground="{DynamicResource SecondaryText}"/>
                        <TextBlock x:Name="QuizCurrentIndex" Text="1" FontSize="20" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryLight}"/>
                        <TextBlock Text=" / " Foreground="{DynamicResource MutedText}"/>
                        <TextBlock x:Name="QuizTotalCount" Text="10" FontSize="20" Foreground="{DynamicResource MutedText}"/>
                    </StackPanel>

                    <!-- Timer -->
                    <StackPanel HorizontalAlignment="Center" Margin="0,0,0,20">
                        <TextBlock x:Name="QuizTimerText" Text="10" FontSize="48" FontWeight="Bold" 
                                   Foreground="{DynamicResource AccentGold}" HorizontalAlignment="Center"/>
                        <Border Background="{DynamicResource SurfaceBackground}" CornerRadius="4" Width="200" Height="8">
                            <Border x:Name="QuizTimerBar" Background="{DynamicResource GradientPrimary}" 
                                    CornerRadius="4" HorizontalAlignment="Left" Width="200"/>
                        </Border>
                    </StackPanel>

                    <!-- Quiz Card - Shows meaning -->
                    <Border Style="{DynamicResource CardStyle}" Padding="30" Margin="0,0,0,20">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="NghÄ©a tiáº¿ng Viá»‡t:" Foreground="{DynamicResource MutedText}" 
                                       HorizontalAlignment="Center"/>
                            <TextBlock x:Name="QuizMeaning" Text="" FontSize="24" FontWeight="Bold" 
                                       Foreground="{DynamicResource PrimaryLight}" HorizontalAlignment="Center"
                                       Margin="0,10,0,0" TextWrapping="Wrap"/>
                            <TextBlock x:Name="QuizHint" Text="" Visibility="Collapsed"
                                       Foreground="{DynamicResource MutedText}" FontSize="12"
                                       HorizontalAlignment="Center" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Record Button -->
                    <StackPanel HorizontalAlignment="Center" Margin="0,0,0,20">
                        <Button x:Name="QuizRecordBtn" Width="100" Height="100" 
                                Style="{DynamicResource PrimaryButton}"
                                Click="QuizRecord_Click">
                            <TextBlock Text="ðŸŽ¤" FontSize="40"/>
                        </Button>
                        <TextBlock x:Name="QuizRecordStatus" Text="Nháº¥n Ä‘á»ƒ tráº£ lá»i" 
                                   Foreground="{DynamicResource MutedText}" 
                                   HorizontalAlignment="Center" Margin="0,15,0,0"/>

                        <!-- Volume Meter -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                            <TextBlock Text="ðŸ”‡ " Foreground="{DynamicResource MutedText}" FontSize="10"/>
                            <Border Background="{DynamicResource SurfaceBackground}" CornerRadius="4" Width="150" Height="8">
                                <Border x:Name="VolumeMeter" Background="{DynamicResource Primary}" 
                                        CornerRadius="4" HorizontalAlignment="Left" Width="0"/>
                            </Border>
                            <TextBlock Text=" ðŸ”Š" Foreground="{DynamicResource MutedText}" FontSize="10"/>
                        </StackPanel>

                        <!-- Noise Calibration -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                            <Button x:Name="CalibrateBtn" Content="ðŸ”‡ Hiá»‡u chá»‰nh tiáº¿ng á»“n"
                                    FontSize="11" Padding="8,4"
                                    Background="Transparent" Foreground="{DynamicResource MutedText}"
                                    BorderBrush="{DynamicResource MutedText}" BorderThickness="1"
                                    Cursor="Hand" Click="CalibrateNoise_Click"/>
                            <TextBlock x:Name="NoiseThresholdText" Text="" 
                                       Foreground="{DynamicResource MutedText}" FontSize="10"
                                       VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- User Answer -->
                    <Border x:Name="QuizAnswerArea" Visibility="Collapsed" 
                            Background="{DynamicResource GlassBackground}" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="Báº¡n nÃ³i:" Foreground="{DynamicResource SecondaryText}"/>
                            <TextBlock x:Name="QuizUserAnswer" Text="" FontSize="18" FontWeight="SemiBold"
                                       Foreground="{DynamicResource PrimaryText}" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Result -->
                    <Border x:Name="QuizResultArea" Visibility="Collapsed" Margin="0,0,0,20">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock x:Name="QuizResultIcon" Text="" FontSize="64" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="QuizResultText" Text="" FontSize="18" FontWeight="SemiBold"
                                       HorizontalAlignment="Center" Margin="0,10,0,0"/>
                            <TextBlock x:Name="QuizCorrectAnswer" Text="" 
                                       Foreground="{DynamicResource MutedText}" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <Button Content="CÃ¢u tiáº¿p theo âž¡ï¸" Style="{DynamicResource PrimaryButton}" 
                                    Margin="0,15,0,0" Click="QuizNext_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Quiz Controls -->
                    <WrapPanel HorizontalAlignment="Center" Margin="0,10,0,0">
                        <Button Content="ðŸ’¡ Gá»£i Ã½" Style="{DynamicResource SecondaryButton}" 
                                Margin="5" Click="QuizHint_Click"/>
                        <Button Content="â­ï¸ Bá» qua" Style="{DynamicResource SecondaryButton}" 
                                Margin="5" Click="QuizSkip_Click"/>
                    </WrapPanel>

                    <!-- Score Summary -->
                    <Border x:Name="QuizScoreSummary" Visibility="Collapsed" Style="{DynamicResource CardStyle}" Margin="0,30,0,0">
                        <StackPanel HorizontalAlignment="Center" Margin="20">
                            <TextBlock Text="ðŸ“Š Káº¿t quáº£" FontSize="20" FontWeight="Bold" 
                                       Foreground="{DynamicResource PrimaryText}" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <StackPanel Margin="30,0">
                                    <TextBlock x:Name="CorrectCount" Text="0" FontSize="48" FontWeight="Bold"
                                               Foreground="{DynamicResource AccentGreen}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="ÄÃºng" Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Margin="30,0">
                                    <TextBlock x:Name="WrongCount" Text="0" FontSize="48" FontWeight="Bold"
                                               Foreground="{DynamicResource AccentPink}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Sai" Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                            <Button Content="ðŸ”„ LÃ m láº¡i" Style="{DynamicResource PrimaryButton}" 
                                    Margin="0,20,0,0" Click="QuizRestart_Click"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Word List Area -->
            <Border x:Name="WordListArea" Visibility="Collapsed" Style="{DynamicResource CardStyle}" Margin="0,20">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="ðŸ“‹ Danh sÃ¡ch tá»« vá»±ng (" FontSize="18" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}"/>
                        <TextBlock x:Name="WordCountText" Text="0" FontSize="18" FontWeight="Bold" 
                                   Foreground="{DynamicResource Primary}"/>
                        <TextBlock Text=" tá»«)" FontSize="18" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}"/>
                    </StackPanel>
                    
                    <ItemsControl x:Name="VocabularyList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{DynamicResource SurfaceBackground}" 
                                        BorderBrush="{DynamicResource Border}" BorderThickness="1" 
                                        CornerRadius="8" Padding="15" Margin="0,5">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Word}" FontWeight="Bold" FontSize="18" 
                                                       Foreground="{DynamicResource PrimaryText}"/>
                                            <TextBlock Text="{Binding Pronunciation}" FontStyle="Italic" 
                                                       Foreground="{DynamicResource MutedText}" Margin="15,0,0,0" 
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding Meaning}" Foreground="{DynamicResource PrimaryLight}" 
                                                   FontSize="15" Margin="0,8,0,0"/>
                                        <TextBlock Text="{Binding Example}" Foreground="{DynamicResource SecondaryText}" 
                                                   FontSize="13" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Empty State -->
            <Border x:Name="EmptyState" Style="{DynamicResource CardStyle}" Padding="60" HorizontalAlignment="Center">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ“š" FontSize="48" HorizontalAlignment="Center"/>
                    <TextBlock Text="Chá»n chá»§ Ä‘á» vÃ  nháº¥n &quot;Táº£i tá»« AI&quot; Ä‘á»ƒ báº¯t Ä‘áº§u há»c" 
                               Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center" Margin="0,15,0,0"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
