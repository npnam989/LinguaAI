<Page x:Class="LinguaAI.Desktop.Pages.WritingPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Luyá»‡n Viáº¿t"
      Style="{DynamicResource PageBase}">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="30">
            <!-- Header -->
            <StackPanel HorizontalAlignment="Center" Margin="0,0,0,30">
                <TextBlock Text="âœï¸ Luyá»‡n Viáº¿t" Style="{DynamicResource HeaderTitle}" HorizontalAlignment="Center"/>
                <TextBlock Text="Viáº¿t bÃ i vÃ  nháº­n pháº£n há»“i chi tiáº¿t tá»« AI" 
                           Style="{DynamicResource SubtitleText}" HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Settings Panel -->
            <Border Style="{DynamicResource GlassPanel}" Margin="0,0,0,30">
                <WrapPanel HorizontalAlignment="Left">
                    <!-- Language Selector -->
                    <StackPanel Margin="10,5">
                        <TextBlock Text="NgÃ´n ngá»¯" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                        <ComboBox x:Name="LanguageComboBox" Width="150" SelectedIndex="0">
                            <ComboBoxItem Content="ðŸ‡°ðŸ‡· Tiáº¿ng HÃ n" Tag="ko"/>
                            <ComboBoxItem Content="ðŸ‡¨ðŸ‡³ Tiáº¿ng Trung" Tag="zh"/>
                            <ComboBoxItem Content="ðŸ‡ºðŸ‡¸ Tiáº¿ng Anh" Tag="en"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Level Selector -->
                    <StackPanel Margin="10,5">
                        <TextBlock Text="TrÃ¬nh Ä‘á»™" Foreground="{DynamicResource SecondaryText}" FontSize="12" Margin="0,0,0,5"/>
                        <ComboBox x:Name="LevelComboBox" Width="130" SelectedIndex="1">
                            <ComboBoxItem Content="SÆ¡ cáº¥p" Tag="beginner"/>
                            <ComboBoxItem Content="Trung cáº¥p" Tag="intermediate"/>
                            <ComboBoxItem Content="Cao cáº¥p" Tag="advanced"/>
                        </ComboBox>
                    </StackPanel>
                </WrapPanel>
            </Border>

            <!-- 2-Column Layout -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Input Area -->
                <Border Style="{DynamicResource CardStyle}" Margin="0,0,15,0">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ BÃ i viáº¿t cá»§a báº¡n" FontSize="18" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}" Margin="0,0,0,15"/>
                        <TextBox x:Name="WritingInput" 
                                 Height="300" TextWrapping="Wrap" AcceptsReturn="True" 
                                 VerticalScrollBarVisibility="Auto"
                                 FontSize="15" Padding="12"
                                 Background="{DynamicResource InputBackground}"
                                 Foreground="{DynamicResource PrimaryText}"
                                 BorderBrush="{DynamicResource Border}"/>
                        <Button x:Name="CheckButton" Content="âœ¨ Kiá»ƒm tra bÃ i viáº¿t" 
                                Style="{DynamicResource PrimaryButton}" Margin="0,15,0,0"
                                HorizontalAlignment="Stretch"
                                Click="CheckButton_Click"/>
                    </StackPanel>
                </Border>

                <!-- Result Area -->
                <Border Grid.Column="1" Style="{DynamicResource CardStyle}">
                    <StackPanel>
                        <TextBlock Text="ðŸ“Š Káº¿t quáº£ phÃ¢n tÃ­ch" FontSize="18" FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}" Margin="0,0,0,15"/>

                        <!-- Loading -->
                        <StackPanel x:Name="LoadingPanel" Visibility="Collapsed" HorizontalAlignment="Center" Margin="0,50">
                            <ProgressBar IsIndeterminate="True" Width="150" Height="4" Foreground="{DynamicResource Primary}"/>
                            <TextBlock Text="Äang phÃ¢n tÃ­ch..." Foreground="{DynamicResource MutedText}" 
                                       HorizontalAlignment="Center" Margin="0,15,0,0"/>
                        </StackPanel>

                        <!-- Results -->
                        <ScrollViewer x:Name="ResultPanel" Visibility="Collapsed" MaxHeight="350" VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <!-- Corrected Text -->
                                <Border Background="{DynamicResource GlassBackground}" CornerRadius="8" Padding="12" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="âœ… Báº£n sá»­a" FontWeight="SemiBold" 
                                                   Foreground="{DynamicResource AccentGreen}" Margin="0,0,0,8"/>
                                        <TextBlock x:Name="CorrectedText" TextWrapping="Wrap" 
                                                   Foreground="{DynamicResource SecondaryText}" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Corrections List -->
                                <TextBlock Text="ðŸ” Chi tiáº¿t lá»—i" FontWeight="SemiBold" 
                                           Foreground="{DynamicResource AccentGold}" Margin="0,0,0,10"/>
                                <ItemsControl x:Name="CorrectionsList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{DynamicResource SurfaceBackground}" 
                                                    Padding="10" CornerRadius="6" Margin="0,0,0,8">
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal" TextBlock.LineHeight="20">
                                                        <TextBlock Text="{Binding Original}" TextDecorations="Strikethrough" 
                                                                   Foreground="{DynamicResource Error}" Margin="0,0,8,0"/>
                                                        <TextBlock Text="âžœ" Foreground="{DynamicResource MutedText}" Margin="0,0,8,0"/>
                                                        <TextBlock Text="{Binding Corrected}" FontWeight="Bold" 
                                                                   Foreground="{DynamicResource AccentGreen}"/>
                                                    </StackPanel>
                                                    <TextBlock Text="{Binding Explanation}" 
                                                               Foreground="{DynamicResource SecondaryText}" 
                                                               FontStyle="Italic" FontSize="12" Margin="0,5,0,0"
                                                               TextWrapping="Wrap"/>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                                <!-- Suggestions -->
                                <TextBlock Text="ðŸ’¡ Gá»£i Ã½ cáº£i thiá»‡n" FontWeight="SemiBold" 
                                           Foreground="{DynamicResource PrimaryLight}" Margin="0,15,0,10"/>
                                <ItemsControl x:Name="SuggestionsList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Foreground="{DynamicResource SecondaryText}" 
                                                       Margin="0,2" TextWrapping="Wrap" FontSize="13">
                                                <Run Text="â€¢ "/><Run Text="{Binding Mode=OneWay}"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Empty State -->
                        <StackPanel x:Name="EmptyState" HorizontalAlignment="Center" Margin="0,50">
                            <TextBlock Text="Viáº¿t bÃ i vÃ  nháº¥n &quot;Kiá»ƒm tra&quot; Ä‘á»ƒ nháº­n pháº£n há»“i" 
                                       Foreground="{DynamicResource MutedText}" TextAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</Page>
